"use strict";

var redis = require('redis');
var argh = require('argh');
var url = require('url');

//--redis redis://127.0.0.1:6379
var opts = {
    'redis' : argh.argv.redis || 'redis://127.0.0.1:6379', // redis://{host}:{port} - redis://127.0.0.1:6379
    'debug' : argh.argv.debug || false
};

var redisUri = url.parse(opts.redis);

var redisConfig = {
    port : redisUri.port,
    host : redisUri.hostname
};

console.log(redisConfig);


var redisPublisher = redis.createClient(redisConfig.port, redisConfig.host);
var redisListener = redis.createClient(redisConfig.port, redisConfig.host);

redis.debug_mode = opts.debug;

/*
redisListener.on("psubscribe", function (pattern, count) {
    console.log("client1 psubscribed to " + pattern + ", " + count + " total subscriptions");
});

redisListener.on("punsubscribe", function (pattern, count) {
    console.log("client1 punsubscribed from " + pattern + ", " + count + " total subscriptions");
    redisListener.end();
});

redisListener.on("pmessage", function (pattern, channel, message) {
    console.log(pattern,channel,JSON.parse(message));

});

redisListener.psubscribe("search.geo*");


*/
